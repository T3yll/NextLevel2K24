// components/AdminNavbarMenu.tsx
'use client';// Ajoutez cette ligne pour marquer le composant comme un Client Component
import React, { useState, useRef, useEffect } from 'react';
import { useRouter } from 'next/navigation'; // Remplacer useRouter par useNavigation pour les composants clients
import Image from 'next/image';

export default function DropDownMenu({ isAdmin, name }:{isAdmin:boolean,name:string}) {
    const [isOpen, setIsOpen] = useState(false);
    const ref = useRef<HTMLDivElement>(null);
    const navigation = useRouter();
  
    useEffect(() => {
      const handleClickOutside = (event: MouseEvent) => {
        if (ref.current && !ref.current.contains(event.target as Node)) {
          setIsOpen(false);
        }
      };
      document.addEventListener('mousedown', handleClickOutside);
      return () => document.removeEventListener('mousedown', handleClickOutside);
    }, [ref]);
  
    const handleAccountManagementClick = () => {
      if (isAdmin) {
        navigation.push('/admin');
      } else {
        navigation.push('/settings');
      }
    };
  
    let ppPath = "/pp/" + name+ ".webp";

    return (
        <div className="relative" ref={ref}>
            <button onClick={() => setIsOpen(!isOpen)}>
                <Image src={ppPath} alt="dropdown" className='h-[60px] w-[60px] rounded-[100px]' height={70} width={70} />
            </button>
            {isOpen && (
                <div className="origin-top-right z-20 absolute right-0 mt-2 w-48 rounded-md shadow-lg text-white bg-[#000000] bg-opacity-[50%] flex justify-center">
                    <div className="flex w-[90%] py-2 gap-2 flex-col items-center">
                        <a 
                            href="#" 
                            className="flex justify-center py-3 text-sm hover:bg-[#CEB2FF] flex-col items-center w-[90%] rounded-[5px]"
                            onClick={handleAccountManagementClick}
                        >
                            {isAdmin ? 'Gestion Admin' : 'Gestion Compte'}
                            {isAdmin ? 
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M18.0625 7.53125C17.6233 6.49162 16.9865 5.54708 16.1875 4.75C15.3904 3.95099 14.4459 3.31423 13.4063 2.875C12.3262 2.41797 11.1816 2.1875 10 2.1875C8.81836 2.1875 7.67383 2.41797 6.59375 2.875C5.55412 3.31423 4.60958 3.95099 3.8125 4.75C3.01349 5.54708 2.37673 6.49162 1.9375 7.53125C1.48047 8.61133 1.25 9.75586 1.25 10.9375C1.25 13.5293 2.38867 15.9707 4.37305 17.6387L4.40625 17.666C4.51953 17.7598 4.66211 17.8125 4.80859 17.8125H15.1934C15.3398 17.8125 15.4824 17.7598 15.5957 17.666L15.6289 17.6387C17.6113 15.9707 18.75 13.5293 18.75 10.9375C18.75 9.75586 18.5176 8.61133 18.0625 7.53125ZM14.8711 16.3281H5.12891C4.37421 15.6476 3.77103 14.8161 3.35851 13.8874C2.94599 12.9587 2.73334 11.9537 2.73438 10.9375C2.73437 8.99609 3.49023 7.17187 4.86328 5.80078C6.23633 4.42773 8.06055 3.67188 10 3.67188C11.9414 3.67188 13.7656 4.42773 15.1367 5.80078C16.5098 7.17383 17.2656 8.99805 17.2656 10.9375C17.2656 13 16.3965 14.9512 14.8711 16.3281ZM12.1777 8.23242C12.1484 8.20334 12.1087 8.18703 12.0674 8.18703C12.0261 8.18703 11.9864 8.20334 11.957 8.23242L10.3066 9.88281C9.94141 9.78516 9.53711 9.87891 9.25 10.166C9.14831 10.2675 9.06763 10.3881 9.01258 10.5208C8.95754 10.6535 8.9292 10.7958 8.9292 10.9395C8.9292 11.0831 8.95754 11.2254 9.01258 11.3581C9.06763 11.4908 9.14831 11.6114 9.25 11.7129C9.3515 11.8146 9.47206 11.8953 9.60477 11.9503C9.73749 12.0054 9.87976 12.0337 10.0234 12.0337C10.1671 12.0337 10.3094 12.0054 10.4421 11.9503C10.5748 11.8953 10.6954 11.8146 10.7969 11.7129C10.9329 11.5773 11.0307 11.4082 11.0804 11.2226C11.1302 11.0371 11.13 10.8417 11.0801 10.6562L12.7305 9.00586C12.791 8.94531 12.791 8.8457 12.7305 8.78516L12.1777 8.23242ZM9.57031 6.25H10.4297C10.5156 6.25 10.5859 6.17969 10.5859 6.09375V4.53125C10.5859 4.44531 10.5156 4.375 10.4297 4.375H9.57031C9.48437 4.375 9.41406 4.44531 9.41406 4.53125V6.09375C9.41406 6.17969 9.48437 6.25 9.57031 6.25ZM14.6484 10.5078V11.3672C14.6484 11.4531 14.7187 11.5234 14.8047 11.5234H16.3672C16.4531 11.5234 16.5234 11.4531 16.5234 11.3672V10.5078C16.5234 10.4219 16.4531 10.3516 16.3672 10.3516H14.8047C14.7187 10.3516 14.6484 10.4219 14.6484 10.5078ZM14.8965 6.65625L14.2891 6.04883C14.2597 6.01975 14.22 6.00344 14.1787 6.00344C14.1374 6.00344 14.0977 6.01975 14.0684 6.04883L12.9629 7.1543C12.9338 7.18366 12.9175 7.22332 12.9175 7.26465C12.9175 7.30598 12.9338 7.34563 12.9629 7.375L13.5703 7.98242C13.6309 8.04297 13.7305 8.04297 13.791 7.98242L14.8965 6.87695C14.957 6.81641 14.957 6.7168 14.8965 6.65625ZM5.93945 6.04883C5.91009 6.01975 5.87043 6.00344 5.8291 6.00344C5.78777 6.00344 5.74812 6.01975 5.71875 6.04883L5.11133 6.65625C5.08225 6.68562 5.06594 6.72527 5.06594 6.7666C5.06594 6.80793 5.08225 6.84759 5.11133 6.87695L6.2168 7.98242C6.27734 8.04297 6.37695 8.04297 6.4375 7.98242L7.04492 7.375C7.10547 7.31445 7.10547 7.21484 7.04492 7.1543L5.93945 6.04883ZM5.11719 10.3516H3.55469C3.46875 10.3516 3.39844 10.4219 3.39844 10.5078V11.3672C3.39844 11.4531 3.46875 11.5234 3.55469 11.5234H5.11719C5.20313 11.5234 5.27344 11.4531 5.27344 11.3672V10.5078C5.27344 10.4219 5.20313 10.3516 5.11719 10.3516Z" fill="white"/>
                            </svg> 
                            :
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M13.125 5C13.125 5.8288 12.7958 6.62366 12.2097 7.20971C11.6237 7.79576 10.8288 8.125 10 8.125C9.17122 8.125 8.37636 7.79576 7.79031 7.20971C7.20426 6.62366 6.87502 5.8288 6.87502 5C6.87502 4.1712 7.20426 3.37634 7.79031 2.79029C8.37636 2.20424 9.17122 1.875 10 1.875C10.8288 1.875 11.6237 2.20424 12.2097 2.79029C12.7958 3.37634 13.125 4.1712 13.125 5ZM3.75085 16.765C3.77763 15.1253 4.4478 13.5618 5.61684 12.4117C6.78587 11.2616 8.36009 10.6171 10 10.6171C11.6399 10.6171 13.2142 11.2616 14.3832 12.4117C15.5522 13.5618 16.2224 15.1253 16.2492 16.765C14.2887 17.664 12.1568 18.1279 10 18.125C7.77002 18.125 5.65335 17.6383 3.75085 16.765Z" stroke="white" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
                            </svg>
                            }
                        </a>
                        <div className='flex w-[90%] h-[1px] bg-[#CEB2FF]'></div>
                        <a href="/" className="flex justify-center py-3 text-sm hover:bg-[#CEB2FF] flex-col items-center w-[90%] rounded-[5px]">DÃ©connexion
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M13.125 7.5V4.375C13.125 3.87772 12.9275 3.40081 12.5758 3.04917C12.2242 2.69754 11.7473 2.5 11.25 2.5H6.25C5.75272 2.5 5.27581 2.69754 4.92417 3.04917C4.57254 3.40081 4.375 3.87772 4.375 4.375V15.625C4.375 16.1223 4.57254 16.5992 4.92417 16.9508C5.27581 17.3025 5.75272 17.5 6.25 17.5H11.25C11.7473 17.5 12.2242 17.3025 12.5758 16.9508C12.9275 16.5992 13.125 16.1223 13.125 15.625V12.5M15.625 12.5L18.125 10M18.125 10L15.625 7.5M18.125 10H7.5" stroke="#FF0000" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
                            </svg>
                        </a>
                    </div>
                </div>
            )}
        </div>
    );
}
